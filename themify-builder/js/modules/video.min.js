(n=>{"use strict";const d=ThemifyBuilderModuleJs.cssUrl+"video_styles/",s=(t,a)=>{const i=n.selectWithParent("module-video",t),o=t=>{const s=t.currentTarget,e=s.closest(".module-video").tfTag("video")[0];if(!s.tfClass("tb_video_buffer")[0]){const a=document.createElement("div"),i=function(t){let e=0<this.duration&&0<this.buffered.length?this.buffered.end(0)/this.duration*100:0;e<2&&(e=0),2<this.readyState&&(e=100,s.tfOff("pointerenter",o,{passive:!0}),this.tfOff("loadstart waiting progress canplay",i,{passive:!0}),a.tfOn("transitionend",t=>{requestAnimationFrame(()=>{this.closest(".tb_hover_play").classList.add("tb_video_loaded"),this.dataset.forceplay=1,n.video([this]),a.remove()})},{passive:!0,once:!0})),2<e&&(a.style.width=e+"%")};n.loadCss("video","tf_video"),n.loadJs("video-player"),a.className="tb_video_buffer tf_abs_t",s.tfTag("img")[0].after(a),e.tfOn("loadstart waiting progress canplay",i,{passive:!0})}e.load()};for(let e=i.length-1;-1<e;--e){let s=i[e],t=s.tfClass("tb_video_overlay")[0];if(s.classList.contains("video-overlay")&&n.loadCss(d+"overlay","tb_video_overlay"),s.classList.contains("tb_hover_play")){if(!n.is_builder_active){let t=s.tfTag("img")[0];t&&t.parentNode.tfOn("pointerenter",o,{passive:!0})}}else if(t)n.loadCss(d+"play_button","tb_video_play_button"),t.tfOn("click",r,{once:!0,passive:!0});else{let e=s.tfTag("noscript")[0];if(e){let t=document.createElement("div");t.innerHTML=e.textContent.trim()||e.innerHTML;const l=t.tfTag("iframe")[0];a&&l&&(l.src=n.updateQueryString("autoplay","1",l.src),l.allow+=";autoplay"),e.replaceWith(t)}else if(a){let t=s.tfTag("video")[0];t.dataset.autoplay=1,n.video([t])}}s.classList.remove("tf_lazy")}},r=function(t){t.stopPropagation();const e=this.closest(".module-video");e.classList.add("tf_lazy"),this.remove(),s(e,1)};n.on("builder_load_module_partial",(t,e)=>{!0===e&&!t.classList.contains("module-video")||s(t)})})(Themify);