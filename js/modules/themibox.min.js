(($,l,a)=>{"use strict";const s={lightboxOpen:!1,init(){if(!l.tfId("post-lightbox-wrap")){const e=l.createDocumentFragment(),o=l.createElement("div"),t=l.createElement("div"),i=l.createElement("div");o.id="post-lightbox-wrap",o.className="album-lightbox tf_hide",i.className="clone-wrap",t.id="overlay",t.tfOn("click",this.closeLightBox).className="tf_w tf_h",e.append(i,o,t),l.body.appendChild(e)}a.body.on("click",".themify-lightbox",this.clickLightBox)},clickLightBox(e){e.preventDefault(),e.stopPropagation();const t=s;if(!0!==t.lightboxOpen){l.tfOn("keyup",t.keyUp,{passive:!0}),t.lightboxOpen=!0;const o=$(this),i=a.updateQueryString("post_in_lightbox",1,o.attr("href"));o.closest("article").find("img").clone().addClass("clone").prependTo(".clone-wrap"),l.body.classList.add("post-lightbox"),$('<div id="loader"><div class="themify-loader"><div class="themify-loader_1 themify-loader_blockG"></div><div class="themify-loader_2 themify-loader_blockG"></div><div class="themify-loader_3 themify-loader_blockG"></div></div></div>').appendTo("body"),$(".clone-wrap").addClass("moved"),$(".clone").addClass("image-clone"),$("#post-lightbox-wrap").empty().load(i+" .album-container",function(){if(s.lightboxOpen){$("#loader").remove();const e=$(this),o=l.createElement("i");o.tfOn("click",t.closeLightBox).className="close-lightbox tf_close",this.insertBefore(o,this.firstChild),e.show(),$(".image-clone").one("transitionend",function(){e.addClass("flipped"),a.reRun(e)}).addClass("flipped")}a.body.triggerHandler("themiboxloaded")})}},closeLightBox(e){e.stopPropagation(),e.preventDefault(),$(".image-clone").remove(),$(".clone-wrap").removeClass("moved").css({top:"",left:""}),l.tfOff("keyup",s.keyUp,{passive:!0}),$("#post-lightbox-wrap").removeClass("flipped"),$("body").removeClass("post-lightbox"),$("#post-lightbox-wrap").empty().hide(),s.lightboxOpen=!1,a.body.triggerHandler("themiboxclosed")},keyUp(e){s.lightboxOpen&&27===e.keyCode&&($(".close-lightbox").click(),$("#loader").remove())}};a.on("themify_theme_themibox_run",()=>{s.init()},!0)})(jQuery,document,Themify);