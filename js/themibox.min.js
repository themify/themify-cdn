(($,l,c)=>{"use strict";const d={topOffset:"50%",isFrameLoading:!1,lightboxOpen:!1,doOnOrientationChange(){d.lightboxOpen&&setTimeout(function(){d.topOffset=window.scrollTop,$("#post-lightbox-wrap").animate({top:d.topOffset},300)},300)},addToBasket(){const e=l.createElement("div"),t=l.createElement("h3"),o=l.createElement("a"),i=l.createElement("a");return e.className="tf_textc lightbox-added",t.textContent=themifyScript.lng.add_to,o.className="button outline",o.href="#",o.textContent=themifyScript.lng.keep_shop,o.addEventListener("click",this.closeLightBox,{once:!0}),i.href=themifyScript.checkout_url,i.className="button checkout",i.textContent=themifyScript.lng.checkout,e.append(t,o,i),e},init(){const e=l.createDocumentFragment(),t=$("body"),o=l.createElement("div"),i=l.createElement("div"),s=l.createElement("div"),a=l.createElement("a");o.id="post-lightbox-wrap",o.className="tf_hide tf_scrollbar",i.id="pattern",i.className="tf_hide tf_w tf_h",s.id="post-lightbox-container",s.className="tf_box tf_w tf_overflow",a.className="close-lightbox",a.href="#",i.addEventListener("click",this.closeLightBox),a.addEventListener("click",this.closeLightBox),o.append(a,s),e.append(o,i),l.body.appendChild(e),l.tfOn("keyup",this.keyUp,{passive:!0}),c.isTouch&&window.tfOn("orientationchange",this.doOnOrientationChange,{passive:!0}),t.on("click",".themify-lightbox",this.clickLightBox).on("added_to_cart",function(){d.lightboxOpen&&($("#post-lightbox-wrap").addClass("lightbox-message"),$("#post-lightbox-container").slideUp(400,function(){$(this).empty(),this.appendChild(d.addToBasket()),$(this).slideDown()}))})},clickLightBox(e){if(e.preventDefault(),d.isFrameLoading)return!1;let t=$(this).prop("href"),s=$("#post-lightbox-container"),a=$("#post-lightbox-wrap"),n=$("body");c.wc(!0),$(".themibox-clicked").removeClass("themibox-clicked"),$(this).addClass("themibox-clicked"),d.isFrameLoading=!0,n.addClass("post-lightbox").css("overflow-y","hidden"),a.hide().removeClass("lightbox-message").addClass("woocommerce"),s.html('<div class="post-lightbox-iframe"></div>'),$.ajax({url:c.updateQueryString("post_in_lightbox","1",t),beforeSend(){$("#pattern").hide().fadeIn(300)},success(o){let i=!0;const e=$('<div class="post-lightbox-temp" id="post-lightbox-wrap"><div id="post-lightbox-container"><div class="post-lightbox-iframe">'+o+"</div></div></div>").get();n.append(e),c.imagesLoad(e).then(e=>{e.remove();let t=l.tfClass("pswp")[0];s.children(".post-lightbox-iframe").append(o),t||(t=s[0].tfClass("pswp")[0])&&l.body.prepend(t),i&&(i=!1,a.fadeIn("normal",function(){"mobile"===c.device&&(d.topOffset=$(window).scrollTop()+10),d.isFrameLoading=!1,d.lightboxOpen=!0,c.trigger("themiboxloaded",this),c.wc(!0)}))})}})},closeLightBox(e){e.preventDefault(),d.lightboxOpen&&$("#pattern").fadeOut(300,function(){const e=$("#post-lightbox-wrap"),t=()=>{$(".post-lightbox-iframe").empty(),$("body").removeClass("post-lightbox").css("overflow-y","visible"),c.trigger("themiboxclosed"),d.lightboxOpen=!1};e.hasClass("lightbox-message")?e.fadeOut("normal",t):e.fadeOut("normal",function(){$(this).removeClass(" woocommerce").find("#pagewrap").remove(),t()})})},keyUp(e){d.lightboxOpen&&27===e.keyCode&&$(".close-lightbox").click()}};c.on("themify_theme_themibox_run",()=>{d.init()},!0)})(jQuery,document,Themify);