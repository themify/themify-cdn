!function($){"use strict";function s(t,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}var o=function(t){t.chosen({disable_search_threshold:7,search_contains:!0,width:"100%"}).on("change",function(t,e){$(t.currentTarget).find("option:not(:first)").prop("disabled","all"===e.selected).trigger("chosen:updated")}).on("chosen:showing_dropdown",function(t){$(t.currentTarget).closest(".ptb_dragged").css("z-index",110)}).on("chosen:hiding_dropdown",function(t){$(t.currentTarget).closest(".ptb_dragged").css("z-index",100)})},t=($(document).on("PTB.close_lightbox",function(t,e){0<$(e).next("#ptb_lightbox_container").find("#ptb-submission-edit-form").length&&!function(){var e=$("#ptb-submission-list-form #the-list"),t=e.closest("form");$.ajax({url:ajaxurl,type:"POST",data:{action:"ptb_submission_list"},beforeSend:function(){t.addClass("ptb-frontend-wait")},complete:function(){t.removeClass("ptb-frontend-wait")},success:function(t){t&&(t=$(t).find("#the-list").html(),e.html(t))}})}()}).on("PTB.template_drag_end",function(t,e,n,s){if("frontend"!==s)return!1;var s=new Array("taxonomies","custom_image","custom_text"),i=e.data("type");if(-1==$.inArray(i,s)&&2<$("#ptb_row_wrapper").find('[data-type="'+i+'"]').length){if(e.hasClass("ptb_is_metabox")){s=e.find("input,select,textarea").attr("name");if(s&&$("#ptb_row_wrapper").find('[data-type="'+i+'"] [name="'+s+'"]').length<2)return o(e.find("select.ptb-select")),!1}return alert(ptb_submission.module+" "+e.find(".ptb_module_name").text()),e.find("."+PTB.prefix+"toggle_module").trigger("click"),e.remove(),!1}o(e.find("select.ptb-select"))}).on("PTB.template_load",function(t,e){var n,s;"frontend"===e&&(o($("#ptb_row_wrapper .ptb-select")),0<$(".ptb_new-themplate").length)&&(e=$("#ptb_cmb_user_email").clone(),n=$("#ptb_cmb_user_name").clone(),s=$("#ptb_cmb_user_password").clone(),$(".ptb_back_col.first .ptb_module_holder").append(e).append(n).append(s).find(".ptb_empty_holder_text").hide(),$(".ptb_back_module_panel #ptb_cmb_title,\n                    .ptb_back_module_panel #ptb_cmb_user_email,\n                    .ptb_back_module_panel #ptb_cmb_user_name,\n                    .ptb_back_module_panel #ptb_cmb_user_password").remove()),$(".ptb_submission_tax_show_as select").trigger("change")}).on("PTB.template_select_grid",function(t,e,n){var s=$("#ptb_row_wrapper select.ptb-select");s.each(function(){$(this).closest("div").html($(this))}),o(s)}),window.addEventListener("load",function(){o($("select.ptb-select")),$("body").on("submit","#ptb-submission-form-save",function(t){t.preventDefault();var e=$(this);$.ajax({url:e.attr("action"),type:"POST",data:e.serialize(),beforeSend:function(){e.addClass("ptb-frontend-wait")},complete:function(){e.removeClass("ptb-frontend-wait")},success:function(t){t&&e.closest(".ptb_lightbox_inner").fadeOut("normal",function(){$(this).html(t).fadeIn()})}})}).on("click",".ptb_submission_templates a.ptb_submission_delete",function(t){var e;t.preventDefault(),confirm(ptb_js_admin.template_delete)&&(e=$(this).closest("form"),$.ajax({url:this,type:"POST",beforeSend:function(){e.addClass("ptb-frontend-wait")},complete:function(){e.removeClass("ptb-frontend-wait")},success:function(t){t&&(t=$(t).find("#the-list").html(),$("#ptb-submission-list-form #the-list").html(t))}}))}).on("change",".ptb_submission_tax_show_as select",function(){var t=$(this).closest(".ptb_active_module").find(".ptb_submission_tax_orderby, .ptb_submission_tax_order");"autocomplete"===$(this).val()?t.slideUp():t.slideDown()}),t()},{once:!0,passive:!0}),function(){var n;$.fn.datepicker?(n=function(t,e){var n=$(".wrap");$.ajax({url:t,type:"POST",data:e,beforeSend:function(){n.addClass("ptb-frontend-wait")},complete:function(){n.removeClass("ptb-frontend-wait")},success:function(t){t&&$("#ptb-submission-posts-wrap").html(t)}})},$(".ptb-submission-datepicker").datepicker({dateFormat:"yy-mm-dd",maxDate:new Date,numberOfMonths:1,onSelect:function(t){"ptb-submission-posts-from"==$(this).attr("id")?$("#ptb-submission-posts-to").datepicker("option","minDate",t):$("#ptb-submission-posts-from").datepicker("option","maxDate",t)}}),$.datepicker.regional[ptb_submission.lng]&&$.datepicker.setDefaults($.datepicker.regional[ptb_submission.lng]),$("#ptb-submission-posts-filter").submit(function(t){t.preventDefault(),t.isTrigger||$(this).find('input[name="paged"]').val(0),n(ajaxurl,$(this).serialize())}),$("#ptb-submission-posts-wrap").on("click",".sortable a,.sorted a",function(t){t.preventDefault();var t=s(this,"order"),e=s(this,"orderby");$('#ptb-submission-posts-filter input[name="order"]').val(t),$('#ptb-submission-posts-filter input[name="orderby"]').val(e),$("#ptb-submission-posts-filter").trigger("submit")}).on("click",".pagination-links a",function(t){t.preventDefault(),$('#ptb-submission-posts-filter input[name="paged"]').val(s(this,"paged")),$("#ptb-submission-posts-filter").trigger("submit")}).on("change",".column-cb input",function(){$("#ptb-submission-posts-wrap").find('input[type="checkbox"]').prop("checked",$(this).is(":checked"))}).on("click","a.ptb-submission-post-action",function(t){if(t.preventDefault(),$(this).hasClass("ptb-submission-post-delete")&&!confirm(ptb_js_admin.template_delete))return!1;n(this)}),$("#ptb-submission-posts-form").on("click",'input[type="submit"]',function(t){t.preventDefault();var t=$(this).closest("form"),e=$(this).closest(".bulkactions").find("select option:selected").val();-1!=e&&0<t.find('input[name="posts[]"]:checked').length&&(t.find('input[name="paged"]').val(0),t.find('input[name="method"]').val(e),n(ajaxurl,t.find("input").serialize()))})):0<$("#ptb-submission-users-form").length&&$('#ptb-submission-users-form input[type="submit"]').click(function(t){var e=$(this).closest("form");-1!=$(this).closest(".bulkactions").find("select option:selected").val()&&0!=e.find('input[name="users[]"]:checked').length||t.preventDefault()})})}(jQuery);